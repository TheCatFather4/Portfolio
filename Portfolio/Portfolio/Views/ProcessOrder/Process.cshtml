@using Portfolio.Models.Cafe.ProcessOrder
@model OrderForm
@{
    Layout = "_CafeLayout";
    ViewData["Title"] = "Process Order";
}

@if (Model.PaymentStatusId != 2)
{
    <div class="text-center my-5" id="titleSection">
        <h3>Before we prepare your order for payment, would you like to add a tip?</h3>
        <h3 class="text-success mt-3">SubTotal: $@Model.TipFormTotal.ToString("F2") (After Tax)</h3>
        <p>10% Tip = $@Model.TipTen.ToString("F2")<br />15% Tip = $@Model.TipFifteen.ToString("F2")<br />20% Tip = $@Model.TipTwenty.ToString("F2")</p>
    </div>
    <div class="container">
        <div class="row">
            <form asp-controller="ProcessOrder" asp-action="Process" method="post" class="border border-info border-3 rounded p-3 bg-primary">
                @Html.AntiForgeryToken()
                <input type="hidden" asp-for="CustomerId" />
                <input type="hidden" asp-for="PaymentTypeId" />
                <input type="hidden" asp-for="SubTotal" />
                <input type="hidden" asp-for="Tax" />
                <div class="form-floating mb-3">
                    <input type="string" class="form-control" asp-for="Tip" value="0.00" id="form-input" />
                    <label asp-for="Tip">Tip</label>
                    <span asp-validation-for="Tip" id="validationText"></span>
                </div>
                <input type="hidden" asp-for="FinalTotal" />
                <input type="hidden" asp-for="PaymentStatusId" />
                <input type="hidden" asp-for="TipFormTotal" />
                <input type="hidden" asp-for="TipTen" />
                <input type="hidden" asp-for="TipFifteen" />
                <input type="hidden" asp-for="TipTwenty" />
                <div>
                    <button class="btn btn-success me-2">Process</button>
                    <a asp-controller="ShoppingCart" asp-action="Index" class="link-light link-opacity-50-hover link-underline-opacity-50-hover">Back to Shopping Cart</a>
                </div>
            </form>
        </div>
    </div>
}
else
{
    <div class="text-center my-5" id="titleSection">
        <h2>Order Summary</h2>
    </div>
    <div class="container">
        <table class="table table-dark table-striped table-hover table-bordered border-primary">
            <thead>
                <tr>
                    <th>Sub Total</th>
                    <th>Tax</th>
                    <th>Tip</th>
                    <th>Final Total</th>
                    <th>Payment Status</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>$@Model.SubTotal.ToString("F2")</td>
                    <td>$@Model.Tax.ToString("F2")</td>
                    <td>$@Model.Tip?.ToString("F2")</td>
                    <td class="text-success">$@Model.FinalTotal.ToString("F2")</td>
                    <td class="text-warning">Pending</td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="text-center my-3">
        <div>
            <h3><a asp-controller="ProcessPayment" asp-action="Process" asp-route-orderId="@Model.OrderId" class="btn btn-success" id="titleSection">Go to Payment</a></h3>
        </div>
    </div>
}